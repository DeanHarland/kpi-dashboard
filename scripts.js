const aiDayData = {
  "03-11-2025": "AI Day 1",
  "04-11-2025": "AI Day 2",
  "05-11-2025": "AI Day 3",
  "06-11-2025": "AI Day 4",
  "07-11-2025": "AI Day 5",

  "10-11-2025": "AI Day 6",
  "11-11-2025": "AI Day 7",
  "12-11-2025": "AI Day 8",
  "13-11-2025": "AI Day 9",
  "14-11-2025": "AI Day 10",

  "17-11-2025": "AI Day 11",
  "18-11-2025": "AI Day 12",
  "19-11-2025": "AI Day 13",
  "20-11-2025": "AI Day 14",
  "21-11-2025": "AI Day 15",

  "24-11-2025": "AI Day 16",
  "25-11-2025": "AI Day 17",
  "26-11-2025": "AI Day 18",
  "27-11-2025": "AI Day 19",
  "28-11-2025": "AI Day 20",

  "01-12-2025": "AI Day 21",
  "02-12-2025": "AI Day 22",
  "03-12-2025": "AI Day 23",
  "04-12-2025": "AI Day 24",
  "05-12-2025": "AI Day 25",

  "08-12-2025": "AI Day 26",
  "09-12-2025": "AI Day 27",
  "10-12-2025": "AI Day 28",
  "11-12-2025": "AI Day 29",
  "12-12-2025": "AI Day 30",

  "15-12-2025": "AI Day 31",
  "16-12-2025": "AI Day 32",
  "17-12-2025": "AI Day 33",
  "18-12-2025": "AI Day 34",
  "19-12-2025": "AI Day 35",

  "05-01-2026": "AI Day 36",
  "06-01-2026": "AI Day 37",
  "07-01-2026": "AI Day 38",
  "08-01-2026": "AI Day 39",
  "09-01-2026": "AI Day 40",

  "12-01-2026": "AI Day 41",
  "13-01-2026": "AI Day 42",
  "14-01-2026": "AI Day 43",
  "15-01-2026": "AI Day 44",
  "16-01-2026": "AI Day 45",

  "19-01-2026": "AI Day 46",
  "20-01-2026": "AI Day 47",
  "21-01-2026": "AI Day 48",
  "22-01-2026": "AI Day 49",
  "23-01-2026": "AI Day 50",

  "26-01-2026": "AI Day 51",
  "27-01-2026": "AI Day 52",
  "28-01-2026": "AI Day 53",
  "29-01-2026": "AI Day 54",
  "30-01-2026": "AI Day 55",

  "02-02-2026": "AI Day 56",
  "03-02-2026": "AI Day 57",
  "04-02-2026": "AI Day 58",
  "05-02-2026": "AI Day 59",
  "06-02-2026": "AI Day 60",

  "09-02-2026": "AI Day 61",
  "10-02-2026": "AI Day 62",
  "11-02-2026": "AI Day 63",
  "12-02-2026": "AI Day 64",
  "13-02-2026": "AI Day 65",

  "16-02-2026": "AI Day 66",
  "17-02-2026": "AI Day 67",
  "18-02-2026": "AI Day 68",
  "19-02-2026": "AI Day 69",
  "20-02-2026": "AI Day 70",

  "23-02-2026": "AI Day 71",
  "24-02-2026": "AI Day 72",
  "25-02-2026": "AI Day 73",
  "26-02-2026": "AI Day 74",
  "27-02-2026": "AI Day 75",

  "02-03-2026": "AI Day 76",
  "03-03-2026": "AI Day 77",
  "04-03-2026": "AI Day 78",
  "05-03-2026": "AI Day 79",
  "06-03-2026": "AI Day 80"
};

const sessionData = {
  "03-11-2025": "Programming Paradigms → Introduction to Ethics in AI",
  "04-11-2025": "HTML Essentials → Lists",
  "05-11-2025": "Tables → Checkbox & Radio Inputs",
  "06-11-2025": "HTML | Dropdown Menus → More media elements Video",
  "07-11-2025": "Semantic Web header nav & footer → Congratulations completing HTML",

  "10-11-2025": "CSS essentials → DOM selectors",
  "11-11-2025": "Inline & Embedded CSS → Units of measurement (%, vw, vh)",
  "12-11-2025": "CSS Font Family → Chrome Developer Tools",
  "13-11-2025": "CSS Box Model (Content/Padding) → Background Source",
  "14-11-2025": "CSS Layout → Z-index",

  "17-11-2025": "CSS Overflow → Module Recap",
  "18-11-2025": "IDE & Deployment Essentials → Deployment Essentials",
  "19-11-2025": "User Experience Essentials → Module Recap",
  "20-11-2025": "Love Running Part 1",
  "21-11-2025": "Love Running Part 2",

  "24-11-2025": "Introduction To Project Planning",
  "25-11-2025": "Introduction to Bootstrap → Customising Bootstrap",
  "26-11-2025": "Boardwalk Games Part 1",
  "27-11-2025": "BoardWalk Games Part 2",
  "28-11-2025": "Intro to Copilot → AI Pair Programming Retrospective",

  "01-12-2025": "Formative assessment & Individual Assignment Prep",
  "02-12-2025": "Individual Flagstone Project",
  "03-12-2025": "Individual Flagstone Project",
  "04-12-2025": "Individual Flagstone Project / Presentations & Peer Reviews",
  "05-12-2025": "End of Module 1 Review – Individual Learner Plans",

  "08-12-2025": "JS Essentials Intro → JavaScript Data Types (Part 2)",
  "09-12-2025": "JavaScript Data Structures & Methods → JavaScript Functions",
  "10-12-2025": "JavaScript Operators & Flow Control → Advanced JS Concepts",
  "11-12-2025": "JS & The Web → Debugging with DevTools",
  "12-12-2025": "JS & The Web → Event Listeners → Module Recap",

  "15-12-2025": "Love Math Part 1 → Adding JavaScript",
  "16-12-2025": "Love Math Part 2 → Tidying up",
  "17-12-2025": "Love Math Part 3 → Module Conclusion",
  "18-12-2025": "JS Debugging in Practice (Placeholder)",
  "19-12-2025": "AI Pair Programming 2",

  "05-01-2026": "Formative Assessment & Hackathon 1 Prep",
  "06-01-2026": "Hackathon 1",
  "07-01-2026": "Hackathon 1",
  "08-01-2026": "Hackathon 1",
  "09-01-2026": "Hackathon Retro / Heroku for Students",

  "12-01-2026": "Frontend Reflection Day → Group JS Presentations → SME/CC Session",
  "13-01-2026": "Module 3 Intro – Python Essentials + Individual Learner Plans",
  "14-01-2026": "Python Essentials Intro → Python-Specific Data Types",
  "15-01-2026": "Python Operators → Python Flow Control",
  "16-01-2026": "Python Iteration → Best Practices",

  "19-01-2026": "Python OOP, Built-In Functions & Tools",
  "20-01-2026": "Python I/O → Exception Handling",
  "21-01-2026": "Heroku Student Account → Virtual Environments",
  "22-01-2026": "DBMS → PostgreSQL & Python (Watch Along)",
  "23-01-2026": "Intro to Agile → Agile Roles",

  "26-01-2026": "User Stories → Final Word on Agile",
  "27-01-2026": "Developing with Django → Deploying to Heroku",
  "28-01-2026": "I Think Therefore I Blog → Code-It-Yourself Models",
  "29-01-2026": "Django Blog Part 2 → Views Part 1",
  "30-01-2026": "Django Blog → Rich Text & Reload → Views Part 2",

  "02-02-2026": "Django Blog → Views Part 3",
  "03-02-2026": "Django Blog → Testing Times",
  "04-02-2026": "Blog Catch-Up Day",
  "05-02-2026": "AI Pair Programming 3",
  "06-02-2026": "Backend Reflection Day",

  "09-02-2026": "Ideation & Project Scoping → Django Deployment Guide",
  "10-02-2026": "Individual Capstone Project",
  "11-02-2026": "Individual Capstone Project",
  "12-02-2026": "Individual Capstone Project",
  "13-02-2026": "Individual Capstone Project",

  "16-02-2026": "SME Project Code Reviews",
  "17-02-2026": "Individual Capstone Project",
  "18-02-2026": "Individual Capstone Project",
  "19-02-2026": "Individual Capstone Project",
  "20-02-2026": "Individual Capstone Project",

  "23-02-2026": "Project Peer Reviews & Pre-Submission Checks",
  "24-02-2026": "Individual Capstone Project",
  "25-02-2026": "Individual Capstone Project",
  "26-02-2026": "Individual Capstone Project",
  "27-02-2026": "Project Submission Day",

  "02-03-2026": "Hackathon Prep",
  "03-03-2026": "Hackathon 2",
  "04-03-2026": "Hackathon 2",
  "05-03-2026": "Hackathon 2",
  "06-03-2026": "Hackathon Retro → End of Bootcamp Review → ILP Updates"
};

function saveCompletedState(completedDates) {
  localStorage.setItem("completedKpiDates", JSON.stringify(completedDates));
}

function loadCompletedState() {
  return JSON.parse(localStorage.getItem("completedKpiDates")) || [];
}

function formatDateDisplay(dateStr) {
const [day, month, year] = dateStr.split('-').map(Number);
const dateObj = new Date(year, month - 1, day);
return dateObj.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
}



function loadToday() {
const today = new Date();
const todayStr = today.toISOString().split("T")[0].split('-').reverse().join('-');
const todayBox = document.getElementById("todayKpi");


if (sessionData[todayStr] && aiDayData[todayStr]) {
todayBox.innerHTML = `
<div class='d-flex justify-content-between align-items-center'>
<div><strong>${formatDateDisplay(todayStr)} - ${aiDayData[todayStr]}</strong></div>
<div class='text-center flex-grow-1'>${sessionData[todayStr]}</div>
</div>`;
} else {
todayBox.innerHTML = `<p>It's a Weekend, go touch some grass!</p>`;
}
}

function loadKpiList() {
  const list = document.getElementById("kpiList");
  let lastWeekday = null;

  // Load saved completed days
  const completedDates = loadCompletedState();

  Object.keys(sessionData).forEach(date => {
    const item = document.createElement("li");
    item.className = "list-group-item d-flex align-items-center";

    // Detect week break
    const [day, month, year] = date.split('-').map(Number);
    const weekday = new Date(year, month - 1, day).getDay();

    if (lastWeekday !== null && weekday < lastWeekday) {
      item.classList.add("week-gap");
    }

    lastWeekday = weekday;

    // LEFT SIDE — Date + AI Day
    const dateDiv = document.createElement("div");
    dateDiv.style.minWidth = "250px";
    dateDiv.innerHTML = `<strong>${formatDateDisplay(date)} - ${aiDayData[date]}</strong>`;

    // CENTER — KPI
    const kpiDiv = document.createElement("div");
    kpiDiv.className = "text-center flex-grow-1";
    kpiDiv.textContent = sessionData[date];

    // If saved as completed → reapply class
    if (completedDates.includes(date)) {
      item.classList.add("completed");
    }

    // Make whole row toggle completion
    item.addEventListener("click", () => {
      item.classList.toggle("completed");
      updateProgressBars();

      if (item.classList.contains("completed")) {
        completedDates.push(date);
      } else {
        const index = completedDates.indexOf(date);
        if (index !== -1) completedDates.splice(index, 1);
      }

      saveCompletedState(completedDates);
    });

    item.appendChild(dateDiv);
    item.appendChild(kpiDiv);
    list.appendChild(item);
  });
}
function updateProgressBars() {
  const allDates = Object.keys(sessionData);
  const completedDates = loadCompletedState();

  const totalDays = allDates.length;
  const completedDays = completedDates.length;

  // --- Actual Progress ---
  const actualPercent = Math.round((completedDays / totalDays) * 100);
  const actualBar = document.getElementById("actualProgressBar");
  actualBar.style.width = `${actualPercent}%`;
  actualBar.textContent = `${actualPercent}%`;

  // --- Expected Progress (based on KPI days) ---
  const today = new Date();
  let expectedDaysElapsed = allDates.filter(d => {
    const [day, month, year] = d.split('-').map(Number);
    const dateObj = new Date(year, month - 1, day);
    return dateObj <= today;
  }).length;

  const expectedPercent = Math.round((expectedDaysElapsed / totalDays) * 100);
  const expectedBar = document.getElementById("expectedProgressBar");
  expectedBar.style.width = `${expectedPercent}%`;
  expectedBar.textContent = `${expectedPercent}%`;
}


loadToday();
loadKpiList();
updateProgressBars();